---
title: "Custom Hook trong ReactJS â€“ Viáº¿t má»™t láº§n, dÃ¹ng má»i nÆ¡i"
publishedAt: "2025-04-06"
summary: "Custom Hook trong ReactJS giÃºp báº¡n tÃ¡i sá»­ dá»¥ng logic mÃ  khÃ´ng cáº§n viáº¿t láº¡i code. HÃ£y cÃ¹ng tÃ¬m hiá»ƒu cÃ¡ch táº¡o vÃ  sá»­ dá»¥ng Custom Hook trong bÃ i viáº¿t nÃ y!"
---


> CÃ³ nhá»¯ng logic láº·p Ä‘i láº·p láº¡i kháº¯p nÆ¡i trong dá»± Ã¡n React cá»§a báº¡n? ChÃ o má»«ng báº¡n Ä‘áº¿n vá»›i tháº¿ giá»›i cá»§a **Custom Hook**.

---

## 1. Custom Hook lÃ  gÃ¬?

Custom Hook Ä‘Æ¡n giáº£n lÃ  má»™t **hÃ m JavaScript** báº¯t Ä‘áº§u báº±ng tá»« `use` vÃ  bÃªn trong cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c hook nhÆ° `useState`, `useEffect`, v.v.

Báº¡n dÃ¹ng `useState` + `useEffect` Ä‘á»ƒ fetch API á»Ÿ 3 component khÃ¡c nhau? Táº¡i sao khÃ´ng gá»™p láº¡i thÃ nh má»™t custom hook cho gá»n?

### VÃ­ dá»¥ Ä‘Æ¡n giáº£n:

```tsx
// useWindowWidth.ts
import { useState, useEffect } from 'react';

export function useWindowWidth() {
  const [width, setWidth] = useState(window.innerWidth);

  useEffect(() => {
    const handleResize = () => setWidth(window.innerWidth);

    window.addEventListener('resize', handleResize);
    return () => window.removeEventListener('resize', handleResize);
  }, []);

  return width;
}
```

### CÃ¡ch dÃ¹ng:

```tsx
const width = useWindowWidth();
return <div>Current width: {width}px</div>;
```

---

## 2. Táº¡i sao nÃªn dÃ¹ng Custom Hook?

- ğŸ§  **TÃ¡i sá»­ dá»¥ng logic** mÃ  khÃ´ng pháº£i láº·p code.
- ğŸ§¼ **TÃ¡ch biá»‡t concern** â€“ chia nhá» logic cho gá»n gÃ ng, dá»… test.
- ğŸ“¦ **Chia sáº» giá»¯a cÃ¡c component** mÃ  khÃ´ng cáº§n HOC hoáº·c render props rÆ°á»m rÃ .

---

## 3. Má»™t sá»‘ Custom Hook phá»• biáº¿n vÃ  há»¯u Ã­ch

### ğŸ” `useFetch`

Tá»± viáº¿t hook Ä‘á»ƒ gá»i API, tráº£ vá» `data`, `loading`, `error`.

```tsx
import { useState, useEffect } from 'react';

export function useFetch<T = any>(url: string) {
  const [data, setData] = useState<T | null>(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<any>(null);

  useEffect(() => {
    let isMounted = true;

    setLoading(true);
    fetch(url)
      .then((res) => res.json())
      .then((data) => isMounted && setData(data))
      .catch((err) => isMounted && setError(err))
      .finally(() => isMounted && setLoading(false));

    return () => {
      isMounted = false;
    };
  }, [url]);

  return { data, loading, error };
}
```

CÃ¡ch dÃ¹ng:

```tsx
const { data, loading, error } = useFetch('https://api.example.com/posts');
```

---

### âŒ¨ï¸ `useDebounce`

Hook dÃ¹ng Ä‘á»ƒ debounce input â€“ trÃ¡nh gá»i API liÃªn tá»¥c khi gÃµ.

```tsx
import { useEffect, useState } from 'react';

export function useDebounce<T>(value: T, delay = 500) {
  const [debouncedValue, setDebouncedValue] = useState(value);

  useEffect(() => {
    const timeout = setTimeout(() => setDebouncedValue(value), delay);
    return () => clearTimeout(timeout);
  }, [value, delay]);

  return debouncedValue;
}
```

CÃ¡ch dÃ¹ng:

```tsx
const [keyword, setKeyword] = useState('');
const debouncedKeyword = useDebounce(keyword, 300);

useEffect(() => {
  fetch(`/api/search?q=${debouncedKeyword}`);
}, [debouncedKeyword]);
```

---

### ğŸ’» `useLocalStorage`

Hook Ä‘á»ƒ get/set localStorage má»™t cÃ¡ch Ä‘Æ¡n giáº£n.

```tsx
import { useState } from 'react';

export function useLocalStorage<T>(key: string, initialValue: T) {
  const [storedValue, setStoredValue] = useState<T>(() => {
    try {
      const item = window.localStorage.getItem(key);
      return item ? JSON.parse(item) : initialValue;
    } catch (error) {
      return initialValue;
    }
  });

  const setValue = (value: T) => {
    setStoredValue(value);
    window.localStorage.setItem(key, JSON.stringify(value));
  };

  return [storedValue, setValue] as const;
}
```

CÃ¡ch dÃ¹ng:

```tsx
const [theme, setTheme] = useLocalStorage('theme', 'light');
```

### ğŸ“± `useMediaQuery` â€“ responsive báº±ng hook, khá»i cáº§n window.matchMedia thá»§ cÃ´ng

```tsx
import { useState, useEffect } from 'react';

export function useMediaQuery(query: string) {
  const [matches, setMatches] = useState(() => window.matchMedia(query).matches);

  useEffect(() => {
    const media = window.matchMedia(query);
    const listener = () => setMatches(media.matches);

    media.addEventListener('change', listener);
    return () => media.removeEventListener('change', listener);
  }, [query]);

  return matches;
}
```

**CÃ¡ch dÃ¹ng:**

```tsx
const isMobile = useMediaQuery('(max-width: 768px)');
return <>{isMobile ? 'Mobile View' : 'Desktop View'}</>;
```

---

### ğŸŒ `useOnlineStatus` â€“ kiá»ƒm tra user Ä‘ang online hay offline

```tsx
import { useEffect, useState } from 'react';

export function useOnlineStatus() {
  const [isOnline, setIsOnline] = useState(navigator.onLine);

  useEffect(() => {
    const updateOnlineStatus = () => setIsOnline(navigator.onLine);

    window.addEventListener('online', updateOnlineStatus);
    window.addEventListener('offline', updateOnlineStatus);

    return () => {
      window.removeEventListener('online', updateOnlineStatus);
      window.removeEventListener('offline', updateOnlineStatus);
    };
  }, []);

  return isOnline;
}
```

**CÃ¡ch dÃ¹ng:**

```tsx
const isOnline = useOnlineStatus();
return <div>{isOnline ? 'Báº¡n Ä‘ang online' : 'Báº¡n Ä‘ang offline ğŸ˜´'}</div>;
```

---

### âŒ› `useTimeout` â€“ delay má»™t hÃ nh Ä‘á»™ng sau vÃ i giÃ¢y

```tsx
import { useEffect, useRef } from 'react';

export function useTimeout(callback: () => void, delay: number) {
  const savedCallback = useRef(callback);

  useEffect(() => {
    savedCallback.current = callback;
  }, [callback]);

  useEffect(() => {
    if (delay === null) return;

    const id = setTimeout(() => savedCallback.current(), delay);
    return () => clearTimeout(id);
  }, [delay]);
}
```

**CÃ¡ch dÃ¹ng:**

```tsx
useTimeout(() => {
  console.log('This runs after 2s');
}, 2000);
```

---

### ğŸ“ `usePrevious` â€“ lÆ°u giÃ¡ trá»‹ trÆ°á»›c Ä‘Ã³ cá»§a biáº¿n

```tsx
import { useEffect, useRef } from 'react';

export function usePrevious<T>(value: T) {
  const ref = useRef<T>();

  useEffect(() => {
    ref.current = value;
  }, [value]);

  return ref.current;
}
```

**CÃ¡ch dÃ¹ng:**

```tsx
const [count, setCount] = useState(0);
const prevCount = usePrevious(count);

return <div>Hiá»‡n táº¡i: {count}, TrÆ°á»›c Ä‘Ã³: {prevCount}</div>;
```

---

### ğŸ¯ `useOnClickOutside` â€“ Ä‘Ã³ng modal, menu khi click ra ngoÃ i

```tsx
import { useEffect } from 'react';

export function useOnClickOutside(ref: React.RefObject<HTMLElement>, handler: (e: MouseEvent) => void) {
  useEffect(() => {
    const listener = (event: MouseEvent) => {
      if (!ref.current || ref.current.contains(event.target as Node)) return;
      handler(event);
    };

    document.addEventListener('mousedown', listener);
    return () => document.removeEventListener('mousedown', listener);
  }, [ref, handler]);
}
```

**CÃ¡ch dÃ¹ng:**

```tsx
const ref = useRef(null);
useOnClickOutside(ref, () => setOpen(false));

return <div ref={ref}>This is a dropdown</div>;
```

---

## 4. Nhá»¯ng lÆ°u Ã½ khi viáº¿t Custom Hook

âœ… TÃªn hook **pháº£i báº¯t Ä‘áº§u báº±ng `use`** (React má»›i nháº­n diá»‡n Ä‘Æ°á»£c).  
âœ… LuÃ´n tuÃ¢n thá»§ **Rules of Hooks**: gá»i hook á»Ÿ top-level, khÃ´ng trong if/for.  
âœ… CÃ³ thá»ƒ gá»i cÃ¡c hook khÃ¡c bÃªn trong custom hook (hook lá»“ng hook).

---

## 5. Tá»•ng káº¿t

Viáº¿t `Custom Hook` lÃ  má»™t ká»¹ nÄƒng cá»±c ká»³ cáº§n thiáº¿t khi lÃ m viá»‡c vá»›i React:

- Dá»± Ã¡n cÃ ng lá»›n, **logic láº·p láº¡i cÃ ng nhiá»u**
- Custom hook giÃºp code sáº¡ch hÆ¡n, dá»… test, dá»… Ä‘á»c
- LÃ  bÆ°á»›c tiáº¿n tá»« â€œxÃ i Ä‘Æ°á»£c Reactâ€ Ä‘áº¿n â€œtÆ° duy Reactâ€

---