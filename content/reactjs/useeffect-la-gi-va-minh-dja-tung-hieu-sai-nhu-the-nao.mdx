---
title: "ğŸ§  useEffect lÃ  gÃ¬ vÃ  mÃ¬nh Ä‘Ã£ tá»«ng hiá»ƒu sai nhÆ° tháº¿ nÃ o?"
publishedAt: "2025-04-08"
summary: "MÃ¬nh Ä‘Ã£ loáº¡i bá» 7 thÃ³i quen xáº¥u trong quy trÃ¬nh coding, giÃºp code sáº¡ch hÆ¡n, hiá»‡u quáº£ hÆ¡nâ€”vÃ  hoÃ n toÃ n khÃ´ng há»‘i tiáº¿c!"
---

> Má»™t láº§n mÃ¬nh tÆ°á»Ÿng `useEffect` lÃ  â€œtháº§n thÃ¡nh", hÃ³a ra mÃ¬nh Ä‘ang dÃ¹ng sai tá»« Ä‘áº§u tá»›i cuá»‘i...

---

## 1. `useEffect` lÃ  gÃ¬?

Trong React, `useEffect` lÃ  má»™t **hook** dÃ¹ng Ä‘á»ƒ xá»­ lÃ½ cÃ¡c **tÃ¡c Ä‘á»™ng phá»¥ (side effects)** â€“ tá»©c lÃ  nhá»¯ng thá»© khÃ´ng liÃªn quan trá»±c tiáº¿p Ä‘áº¿n viá»‡c hiá»ƒn thá»‹ giao diá»‡n (render).  

VÃ­ dá»¥:

- Gá»i API Ä‘á»ƒ láº¥y dá»¯ liá»‡u
- Láº¯ng nghe sá»± kiá»‡n bÃ n phÃ­m, chuá»™t, scroll...
- Thiáº¿t láº­p hoáº·c dá»n dáº¹p `setInterval`, `setTimeout`
- Cáº­p nháº­t `document.title`, lÆ°u vÃ o localStorage...

NÃ³i cÃ¡ch khÃ¡c, náº¿u thá»© báº¡n Ä‘ang lÃ m cÃ³ thá»ƒ gÃ¢y **áº£nh hÆ°á»Ÿng bÃªn ngoÃ i component**, thÃ¬ kháº£ nÄƒng cao báº¡n cáº§n `useEffect`.

CÃº phÃ¡p cÆ¡ báº£n:

```jsx
useEffect(() => {
  // code á»Ÿ Ä‘Ã¢y sáº½ cháº¡y sau má»—i láº§n render (náº¿u khÃ´ng cÃ³ dependency array)
});
```

Hoáº·c:

```jsx
useEffect(() => {
  console.log('Component mounted');
}, []);
```

CÃ¡i `[]` á»Ÿ cuá»‘i gá»i lÃ  **dependency array** â€“ danh sÃ¡ch cÃ¡c giÃ¡ trá»‹ khi thay Ä‘á»•i thÃ¬ `useEffect` sáº½ cháº¡y láº¡i.

---

## 2. MÃ¬nh Ä‘Ã£ tá»«ng hiá»ƒu sai nhÆ° tháº¿ nÃ o?

### âŒ Sai láº§m 1: Cá»© má»—i láº§n render lÃ  `useEffect` cháº¡y?

Ban Ä‘áº§u mÃ¬nh nghÄ© lÃ  `useEffect` cháº¡y láº¡i sau **má»—i láº§n render**, nÃªn mÃ¬nh Ä‘á»ƒ `console.log()` trong Ä‘Ã³ vÃ â€¦ báº¥t ngá» vÃ¬ nÃ³ **khÃ´ng cháº¡y láº¡i**.

HÃ³a ra, khi Ä‘á»ƒ `[]` (tá»©c lÃ  **khÃ´ng cÃ³ dependency nÃ o**), thÃ¬ `useEffect` chá»‰ cháº¡y **má»™t láº§n duy nháº¥t** â€“ tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i **componentDidMount** trong class component.

```jsx
useEffect(() => {
  console.log('Cháº¡y má»™t láº§n duy nháº¥t khi component mount');
}, []);
```

CÃ²n náº¿u báº¡n muá»‘n nÃ³ cháº¡y láº¡i khi má»™t biáº¿n nÃ o Ä‘Ã³ thay Ä‘á»•i, báº¡n **pháº£i Ä‘Æ°a biáº¿n Ä‘Ã³ vÃ o dependency array**.

---

### âŒ Sai láº§m 2: QuÃªn thÃªm dependencies

VÃ­ dá»¥ nÃ y tá»«ng khiáº¿n mÃ¬nh Ä‘au Ä‘áº§u vÃ i tiáº¿ng:

```jsx
useEffect(() => {
  fetchData(keyword);
}, []);
```

MÃ¬nh nghÄ© `useEffect` sáº½ tá»± biáº¿t lÃ  khi `keyword` thay Ä‘á»•i thÃ¬ pháº£i cháº¡y láº¡i. NhÆ°ng khÃ´ng. NÃ³ cháº¡y **má»™t láº§n duy nháº¥t** vÃ¬ `[]` nghÄ©a lÃ : â€œÃŠ React, Ä‘á»«ng quan tÃ¢m gÃ¬ háº¿t, chá»‰ cháº¡y láº§n Ä‘áº§u thÃ´i nha.â€

âœ… CÃ¡ch Ä‘Ãºng:

```jsx
useEffect(() => {
  fetchData(keyword);
}, [keyword]);
```

Má»—i khi `keyword` thay Ä‘á»•i, `useEffect` sáº½ cháº¡y láº¡i.

---

### âŒ Sai láº§m 3: KhÃ´ng cleanup dáº«n Ä‘áº¿n rÃ² rá»‰ bá»™ nhá»› (memory leak)

MÃ¬nh tá»«ng táº¡o má»™t `setInterval` trong `useEffect` nhÆ° váº§y:

```jsx
useEffect(() => {
  const interval = setInterval(() => {
    console.log('Tick');
  }, 1000);
}, []);
```

Káº¿t quáº£? Khi chuyá»ƒn sang trang khÃ¡c (component bá»‹ unmount), cÃ¡i `interval` kia **váº«n cháº¡y**. GÃ¢y rÃ² rá»‰ bá»™ nhá»› vÃ  bug khÃ³ chá»‹u.

âœ… CÃ¡ch Ä‘Ãºng lÃ  pháº£i **dá»n dáº¹p (cleanup)**:

```jsx
useEffect(() => {
  const interval = setInterval(() => {
    console.log('Tick');
  }, 1000);

  return () => {
    clearInterval(interval); // Dá»n dáº¹p khi component unmount
  };
}, []);
```

`useEffect` cho phÃ©p báº¡n **return má»™t hÃ m**, vÃ  React sáº½ gá»i hÃ m Ä‘Ã³ **trÆ°á»›c khi component bá»‹ unmount** hoáº·c **trÆ°á»›c khi cháº¡y láº¡i effect má»›i**.

---

## 3. Sau khi hiá»ƒu rÃµ hÆ¡n, mÃ¬nh rÃºt ra bÃ i há»c gÃ¬?

- Äá»«ng coi `[]` lÃ  máº·c Ä‘á»‹nh â€“ hÃ£y dÃ¹ng nÃ³ cáº©n tháº­n.
- Báº¥t ká»³ biáº¿n nÃ o báº¡n **dÃ¹ng trong `useEffect`** mÃ  cÃ³ thá»ƒ thay Ä‘á»•i, thÃ¬ báº¡n nÃªn **Ä‘Æ°a nÃ³ vÃ o dependency array**.
- Náº¿u táº¡o ra thá»© gÃ¬ cáº§n â€œdá»n dáº¹p" (event listener, interval...), thÃ¬ pháº£i return má»™t hÃ m Ä‘á»ƒ cleanup.
- CÃ i plugin ESLint dÃ nh cho React Ä‘á»ƒ cáº£nh bÃ¡o khi thiáº¿u dependency.

---

## 4. Tá»•ng káº¿t

`useEffect` khÃ´ng khÃ³, nhÆ°ng cÅ©ng cháº³ng dá»….  
MÃ¬nh tá»«ng nghÄ© mÃ¬nh hiá»ƒu nÃ³, nhÆ°ng rá»“i láº¡i dÃ¹ng sai cÃ¡ch.  

NhÆ°ng khi Ä‘Ã£ **hiá»ƒu Ä‘Ãºng cÃ¡ch hoáº¡t Ä‘á»™ng**, `useEffect` trá»Ÿ thÃ nh má»™t **vÅ© khÃ­ cá»±c máº¡nh** giÃºp component pháº£n á»©ng Ä‘Ãºng vá»›i dá»¯ liá»‡u, gá»i API há»£p lÃ½ vÃ  kiá»ƒm soÃ¡t side effects gá»n gÃ ng hÆ¡n.

---

## ğŸ“Œ Báº¡n thÃ¬ sao?

Báº¡n Ä‘Ã£ tá»«ng gáº·p lá»—i nÃ o â€œhÃ i hÆ°á»›c" khi dÃ¹ng `useEffect` chÆ°a? HÃ£y chia sáº» Ä‘á»ƒ cÃ¹ng cÆ°á»i má»™t cÃ¡i vÃ  há»c há»i thÃªm nhÃ© ğŸ˜„

---

Náº¿u báº¡n thÃ­ch, mÃ¬nh cÃ³ thá»ƒ tiáº¿p tá»¥c giÃºp báº¡n viáº¿t bÃ i tiáº¿p theo cho ngÃ y mai. Báº¡n muá»‘n viáº¿t chá»§ Ä‘á» gÃ¬ tiáº¿p theo? Hay mÃ¬nh gá»£i Ã½ cho?