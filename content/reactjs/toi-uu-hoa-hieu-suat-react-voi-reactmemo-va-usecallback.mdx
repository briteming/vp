---
title: "Tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t React vá»›i React.memo vÃ  useCallback"
publishedAt: "2025-04-05"
summary: "CÃ¡ch tá»‘i Æ°u hiá»‡u suáº¥t trong React báº±ng React.memo vÃ  useCallback. Giáº£m thiá»ƒu re-render khÃ´ng cáº§n thiáº¿t, tÄƒng tá»‘c Ä‘á»™ á»©ng dá»¥ng."
---

> "Táº¡i sao component con cá»§a tÃ´i cá»© re-render hoÃ i dÃ¹ props khÃ´ng Ä‘á»•i?"  
> CÃ³ thá»ƒ báº¡n Ä‘ang thiáº¿u má»™t chÃºt tá»‘i Æ°u vá»›i `React.memo` vÃ  `useCallback`.

---

## 1. CÃ¢u chuyá»‡n báº¯t Ä‘áº§u tá»« Ä‘Ã¢u?

Khi má»™t component cha render láº¡i â€“ báº¥t ká»ƒ vÃ¬ state nÃ o thay Ä‘á»•i â€“ thÃ¬ **táº¥t cáº£ component con** cÅ©ng sáº½ re-render, *trá»« khi báº¡n kiá»ƒm soÃ¡t Ä‘iá»u Ä‘Ã³*.

Äiá»u nÃ y **cÃ³ thá»ƒ gÃ¢y giáº£m hiá»‡u suáº¥t**, nháº¥t lÃ  náº¿u component con náº·ng (VD: danh sÃ¡ch, biá»ƒu Ä‘á»“, dropdown...).

---

## 2. Giáº£i phÃ¡p: `React.memo` vÃ  `useCallback`

### âœ… `React.memo`

`React.memo` lÃ  má»™t **HOC (Higher Order Component)** giÃºp **memo hÃ³a component** â€“ tá»©c lÃ  **giá»¯ láº¡i káº¿t quáº£ render trÆ°á»›c Ä‘Ã³**, vÃ  chá»‰ render láº¡i náº¿u props thay Ä‘á»•i.

```tsx
const MyComponent = React.memo(function MyComponent({ name }: { name: string }) {
  console.log('Re-render MyComponent');
  return <div>Hello, {name}</div>;
});
```

---

### âœ… `useCallback`

`useCallback` giÃºp **memo hÃ³a hÃ m callback** â€“ tá»©c lÃ  giá»¯ nguyÃªn reference cá»§a má»™t hÃ m qua cÃ¡c láº§n render, trá»« khi dependency thay Ä‘á»•i.

```tsx
const handleClick = useCallback(() => {
  console.log('Clicked!');
}, []);
```

---

## 3. VÃ­ dá»¥ minh há»a: KhÃ´ng tá»‘i Æ°u vs CÃ³ tá»‘i Æ°u

### âŒ KhÃ´ng tá»‘i Æ°u: Component con re-render má»—i láº§n cha render

```tsx
const Child = ({ onClick }: { onClick: () => void }) => {
  console.log('Child render');
  return <button onClick={onClick}>Click me</button>;
};

const Parent = () => {
  const [count, setCount] = useState(0);

  const handleClick = () => console.log('Clicked');

  return (
    <>
      <button onClick={() => setCount(count + 1)}>Increment</button>
      <Child onClick={handleClick} />
    </>
  );
};
```

â¡ Má»—i láº§n báº¥m "Increment", `Parent` render láº¡i â†’ `handleClick` Ä‘Æ°á»£c táº¡o láº¡i â†’ `Child` cÅ©ng bá»‹ render láº¡i, **dÃ¹ khÃ´ng cáº§n thiáº¿t**.

---

### âœ… CÃ³ tá»‘i Æ°u: Giá»¯ nguyÃªn callback + memo hÃ³a component

```tsx
const Child = React.memo(({ onClick }: { onClick: () => void }) => {
  console.log('Child render');
  return <button onClick={onClick}>Click me</button>;
});

const Parent = () => {
  const [count, setCount] = useState(0);

  const handleClick = useCallback(() => {
    console.log('Clicked');
  }, []);

  return (
    <>
      <button onClick={() => setCount(count + 1)}>Increment</button>
      <Child onClick={handleClick} />
    </>
  );
};
```

â¡ LÃºc nÃ y, `Child` chá»‰ render Ä‘Ãºng má»™t láº§n â€“ khi callback khÃ´ng Ä‘á»•i vÃ  props khÃ´ng thay Ä‘á»•i.

---

## 4. Nhá»¯ng hiá»ƒu láº§m thÆ°á»ng gáº·p

### â— `React.memo` khÃ´ng "tá»± Ä‘á»™ng tá»‘i Æ°u" cho báº¡n  
NÃ³ **so sÃ¡nh `props` báº±ng `shallow compare`**, nÃªn náº¿u báº¡n truyá»n object má»›i má»—i láº§n, nÃ³ váº«n render.

```tsx
<Child data={{ name: 'Dinh' }} /> // má»—i láº§n render lÃ  má»™t object má»›i â†’ render láº¡i
```

ğŸ‘‰ Giáº£i phÃ¡p: Memo hÃ³a object báº±ng `useMemo`, hoáº·c truyá»n dá»¯ liá»‡u Ä‘Æ¡n giáº£n.

---

### â— `useCallback` khÃ´ng giáº£m sá»‘ láº§n cháº¡y hÃ m  
NÃ³ chá»‰ **giá»¯ láº¡i hÃ m cÅ© náº¿u dependency khÃ´ng Ä‘á»•i** â€“ khÃ´ng pháº£i "cháº·n" callback.

---

## 5. Khi nÃ o nÃªn dÃ¹ng?

- **Khi component con náº·ng**: Náº¿u báº¡n tháº¥y component con render láº¡i nhiá»u láº§n mÃ  khÃ´ng cáº§n thiáº¿t, hÃ£y thá»­ `React.memo`.
- **Khi callback Ä‘Æ°á»£c truyá»n xuá»‘ng nhiá»u láº§n**: Náº¿u báº¡n truyá»n má»™t hÃ m callback cho nhiá»u component con, hÃ£y dÃ¹ng `useCallback` Ä‘á»ƒ trÃ¡nh táº¡o láº¡i hÃ m má»—i láº§n render.
- **Khi báº¡n tháº¥y hiá»‡u suáº¥t giáº£m**: Náº¿u á»©ng dá»¥ng cá»§a báº¡n cháº­m láº¡i khi cÃ³ nhiá»u component, hÃ£y xem xÃ©t tá»‘i Æ°u hÃ³a vá»›i cáº£ hai.
- **KhÃ´ng láº¡m dá»¥ng**: Chá»‰ dÃ¹ng khi cáº§n thiáº¿t. Náº¿u component nháº¹, viá»‡c tá»‘i Æ°u hÃ³a cÃ³ thá»ƒ khÃ´ng cáº§n thiáº¿t vÃ  chá»‰ lÃ m code phá»©c táº¡p hÆ¡n.
- **Äá»«ng quÃªn kiá»ƒm tra hiá»‡u suáº¥t**: Sá»­ dá»¥ng cÃ´ng cá»¥ nhÆ° React DevTools Ä‘á»ƒ theo dÃµi sá»‘ láº§n render vÃ  hiá»‡u suáº¥t tá»•ng thá»ƒ.
- **Káº¿t há»£p vá»›i `useMemo`**: Náº¿u báº¡n cÃ³ tÃ­nh toÃ¡n náº·ng trong component, hÃ£y dÃ¹ng `useMemo` Ä‘á»ƒ trÃ¡nh tÃ­nh toÃ¡n láº¡i khÃ´ng cáº§n thiáº¿t.
- **TrÃ¡nh dÃ¹ng cho má»i component**: Chá»‰ Ã¡p dá»¥ng cho nhá»¯ng component cÃ³ kháº£ nÄƒng re-render nhiá»u láº§n mÃ  khÃ´ng cáº§n thiáº¿t.
- **Kiá»ƒm tra hiá»‡u suáº¥t trÆ°á»›c vÃ  sau**: Äo lÆ°á»ng hiá»‡u suáº¥t trÆ°á»›c vÃ  sau khi Ã¡p dá»¥ng Ä‘á»ƒ xem cÃ³ cáº£i thiá»‡n khÃ´ng.

---

## 6. Váº­y táº¡i sao láº¡i khÃ´ng nÃªn láº¡m dá»¥ng trong khi nÃ³ cÃ³ thá»ƒ tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t?

>Nghe thÃ¬ cÃ³ váº»: *â€œMemo thÃ¬ tá»‘t, sao láº¡i khÃ´ng dÃ¹ng luÃ´n cho cháº¯c?â€* â€” nhÆ°ng thá»±c táº¿ **React.memo vÃ  useCallback khÃ´ng miá»…n phÃ­** Ä‘Ã¢u, chÃºng cÅ©ng **cÃ³ "cost" (chi phÃ­)** riÃªng. MÃ¬nh giáº£i thÃ­ch ká»¹ cho báº¡n hiá»ƒu vÃ¬ sao **khÃ´ng nÃªn láº¡m dá»¥ng**, dÃ¹ nÃ³ lÃ  cÃ´ng cá»¥ tá»‘i Æ°u máº¡nh máº½:

---

### â—a. `React.memo` cÅ©ng pháº£i... so sÃ¡nh `props`

Má»—i láº§n parent re-render, `React.memo` sáº½ **cháº¡y láº¡i má»™t hÃ m `shallow comparison`** Ä‘á»ƒ kiá»ƒm tra xem props má»›i cÃ³ khÃ¡c props cÅ© khÃ´ng.

â¡ Náº¿u component con Ä‘Æ¡n giáº£n, chá»‰ cÃ³ vÃ i dÃ²ng JSX, thÃ¬ viá»‡c "so sÃ¡nh props" Ä‘Ã´i khi **cÃ²n tá»‘n cÃ´ng hÆ¡n viá»‡c re-render luÃ´n**!

#### ğŸ’¥ VÃ­ dá»¥:
```tsx
const TinyComponent = React.memo(({ label }) => <span>{label}</span>);
```
Náº¿u `label` luÃ´n lÃ  string má»›i, má»—i láº§n parent render láº¡i thÃ¬:
- React pháº£i cháº¡y `shallow compare`
- Káº¿t quáº£: váº«n pháº£i render láº¡i

ğŸ‘‰ **Káº¿t luáº­n:** Memo hÃ³a cÃ¡i nhá» quÃ¡ â†’ khÃ´ng lá»£i gÃ¬, cÃ²n tá»‘n thÃªm bÆ°á»›c kiá»ƒm tra props.

---

#### â—b. `useCallback` giá»¯ láº¡i reference, nhÆ°ng cÅ©ng tiÃªu tá»‘n bá»™ nhá»›

`useCallback` vá» báº£n cháº¥t lÃ  `useMemo` cho function. NÃ³:
- **Giá»¯ function trong bá»™ nhá»›**
- **Theo dÃµi dependency** (náº¿u dependency thay Ä‘á»•i, táº¡o láº¡i function má»›i)

â¡ Náº¿u báº¡n cÃ³ quÃ¡ nhiá»u `useCallback`, React pháº£i theo dÃµi nhiá»u dependency â†’ tÄƒng complexity, vÃ  Ä‘Ã´i khi **code trá»Ÿ nÃªn khÃ³ Ä‘á»c** hÆ¡n vÃ¬ Ä‘áº§y `useCallback`, `useMemo`.

---

#### â—c. Khi khÃ´ng cÃ³ váº¥n Ä‘á», tá»‘i Æ°u sá»›m = phÃ­ cÃ´ng

Má»™t nguyÃªn táº¯c "vÃ ng" trong láº­p trÃ¬nh:  
> **â€œDonâ€™t optimize prematurely.â€** â€“ Äá»«ng tá»‘i Æ°u quÃ¡ sá»›m khi chÆ°a gáº·p váº¥n Ä‘á».

Náº¿u component:
- Nhá», Ä‘Æ¡n giáº£n
- KhÃ´ng bá»‹ render nhiá»u
- KhÃ´ng bá»‹ lag, khÃ´ng cháº­m

ğŸ‘‰ ThÃ¬ **viá»‡c thÃªm `memo`, `useCallback` khÃ´ng cáº£i thiá»‡n gÃ¬ cáº£**, Ä‘Ã´i khi cÃ²n khiáº¿n code khÃ³ maintain hÆ¡n.

---

### âœ… Váº­y khi nÃ o dÃ¹ng lÃ  **há»£p lÃ½**?

- **Component náº·ng**: Náº¿u component cÃ³ nhiá»u logic, nhiá»u props, hoáº·c render nhiá»u láº§n â†’ dÃ¹ng `React.memo` vÃ  `useCallback`.
- **Component con**: Náº¿u báº¡n cÃ³ nhiá»u component con trong má»™t parent, vÃ  chá»‰ má»™t trong sá»‘ Ä‘Ã³ cáº§n re-render â†’ dÃ¹ng `React.memo` cho component Ä‘Ã³.
- **Callback phá»©c táº¡p**: Náº¿u báº¡n truyá»n má»™t hÃ m callback phá»©c táº¡p cho nhiá»u component con â†’ dÃ¹ng `useCallback` Ä‘á»ƒ trÃ¡nh táº¡o láº¡i hÃ m má»—i láº§n render.
- **Khi tháº¥y hiá»‡u suáº¥t giáº£m**: Náº¿u báº¡n tháº¥y á»©ng dá»¥ng cháº­m láº¡i khi cÃ³ nhiá»u component, hÃ£y xem xÃ©t tá»‘i Æ°u hÃ³a vá»›i cáº£ hai.

---

### âœ¨ Tá»•ng káº¿t: ÄÃºng lÃºc, Ä‘Ãºng chá»— má»›i lÃ  "nghá»‡ thuáº­t React"

Tá»‘i Æ°u lÃ  **con dao hai lÆ°á»¡i**:
- DÃ¹ng Ä‘Ãºng lÃºc â†’ mÆ°á»£t mÃ , hiá»‡u suáº¥t cao
- Láº¡m dá»¥ng â†’ phá»©c táº¡p, khÃ´ng cáº§n thiáº¿t

Váº­y nÃªn, chá»‰ cáº§n nhá»›:  
> **React.memo vÃ  useCallback lÃ  cÃ´ng cá»¥ tá»‘i Æ°u â€“ khÃ´ng pháº£i máº·c Ä‘á»‹nh pháº£i cÃ³.**

---

## 7. Tá»•ng káº¿t

- **`React.memo`**: trÃ¡nh re-render component náº¿u props khÃ´ng thay Ä‘á»•i
- **`useCallback`**: trÃ¡nh táº¡o láº¡i function khÃ´ng cáº§n thiáº¿t
- Káº¿t há»£p cáº£ 2 giÃºp **giáº£m render thá»«a**, tÄƒng hiá»‡u suáº¥t Ä‘Ã¡ng ká»ƒ
- Äá»«ng "láº¡m dá»¥ng" â€“ chá»‰ dÃ¹ng khi tháº¥y hiá»‡u suáº¥t giáº£m hoáº·c component quÃ¡ náº·ng

---